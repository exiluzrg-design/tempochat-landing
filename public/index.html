<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TempoChat ‚Äî charlas privadas en 10 minutos</title>
  <meta name="description" content="Sesiones privadas de 10 minutos, sin registro, 24/7 y con memoria de conversaci√≥n. Privacidad real y foco en lo que necesit√°s ahora." />
  <style>
    :root{ --bg:#0b0b0c; --panel:#141417; --panel-2:#101013; --text:#e8e8ec; --muted:#a7a7b2; --line:#222227; --brand:#2f81f7; }
    *{ box-sizing:border-box }
    html,body{ margin:0; padding:0; background:var(--bg); color:var(--text); font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif }
    .wrap{ max-width:1080px; margin:0 auto; padding:24px }
    header{ display:flex; align-items:center; justify-content:space-between; gap:16px; padding:12px 0; border-bottom:1px solid var(--line) }
    .brand{ display:flex; align-items:center; gap:10px }
    .logo{ width:28px; height:28px; border-radius:8px; background:linear-gradient(135deg,var(--brand),#7aa5ff) }

    .hero{ padding:28px 0 }
    .hero h1{ font-size:clamp(28px,4vw,44px); line-height:1.1; margin:0 0 10px }
    .hero p{ color:var(--muted); margin:0 0 18px }

    .chat{ display:flex; flex-direction:column; height:460px; margin-top:12px }
    .chatlog{ flex:1; overflow:auto; border:1px solid var(--line); border-radius:12px; padding:10px; background:var(--panel-2) }
    .msg{ max-width:80%; padding:10px 14px; border-radius:14px; margin:6px 0; line-height:1.45 }
    .user{ background:#2b2b34; margin-left:auto; border-bottom-right-radius:4px }
    .assistant{ background:#1b1b20; margin-right:auto; border-bottom-left-radius:4px }
    .system{ color:var(--muted); text-align:center; margin:4px 0 }
    .typing{ display:none; color:var(--muted); margin:6px 0 }
    .row{ display:flex; gap:8px; margin-top:10px }
    input,button{ font:inherit }
    .row input{ flex:1; background:#121216; color:var(--text); border:1px solid var(--line); border-radius:12px; padding:10px }
    .row button{ background:var(--brand); color:#fff; border:none; border-radius:12px; padding:10px 14px; cursor:pointer }
    .error{ color:#ff7a7a; font-size:13px; margin-top:6px; display:none }
    .timer{ font-size:14px; color:var(--muted); margin:6px 0; text-align:center }

    .nudge{ display:none; gap:8px; justify-content:center; margin:6px 0 }
    .ghost{ background:transparent; border:1px solid var(--line); color:var(--text) }

    .closing-banner{ position:fixed; left:0; right:0; bottom:20px; margin:0 auto; max-width:1080px; background:#1b1b20; border:1px solid var(--line); border-radius:12px; padding:10px 14px; color:var(--muted); text-align:center; display:none; box-shadow:0 8px 24px rgba(0,0,0,.3); }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand"><div class="logo"></div><strong>TempoChat</strong></div>
    </header>

    <section class="hero">
      <h1>Charlas privadas de 10 minutos</h1>
      <p>Un espacio breve y seguro para ordenar ideas y salir con un pr√≥ximo paso claro.</p>
    </section>

    <section>
      <div class="chat">
        <div class="chatlog" id="chatlog">
          <div class="system">Bienvenido a la demo. Ten√©s 10 minutos para conversar. Empez√° escribiendo abajo üëá</div>
        </div>
        <div class="timer" id="timer">Tiempo restante: 10:00</div>

        <div class="nudge" id="nudge">
          <button class="btn" id="addTime">Agregar 5‚Ä≤</button>
          <button class="btn ghost" id="wrapUp">Vamos cerrando</button>
        </div>

        <div class="typing" id="typing">‚è≥ escribiendo‚Ä¶</div>
        <div class="error" id="error"></div>
        <div class="row">
          <input id="msg" placeholder="Escrib√≠ ac√°‚Ä¶" />
          <button id="send">Enviar</button>
        </div>
      </div>
    </section>
  </div>

  <div id="closingBanner" class="closing-banner">Cierre en curso‚Ä¶ generando conclusi√≥n final</div>

  <script>
    // --------- elementos y estado ----------
    let currentReqId = 0;
    const $ = (id) => document.getElementById(id);
    const chatlog = $('chatlog');
    const typing = $('typing');
    const errorBox = $('error');
    const input = $('msg');
    const btn = $('send');
    const timerEl = $('timer');
    const nudge = $('nudge');
    const btnAddTime = $('addTime');
    const btnWrap = $('wrapUp');
    const closingBanner = $('closingBanner');

    let sessionSeconds = 600;
    let interval; let askedAtNine = false;
    let closing = false;
    let retriedAfter410 = false;

    let autosendTimer = null;
    const AUTOSEND_MS = 1700;
    const AUTOSEND_MIN_CHARS = 6;
    const AUTOSEND_ENDING = /[.!?‚Ä¶)]$/;

    // Apertura autom√°tica: saludo breve (sin pedir nombre ni estado)
    const OPENING_PROMPT = [
      'Salud√° en una sola oraci√≥n, tono c√°lido rioplatense.',
      'No hagas preguntas iniciales.',
      'No pidas nombre ni c√≥mo se siente.',
      'Dec√≠ que la sesi√≥n dura 10 minutos y que puede empezar cuando quiera.'
    ].join(' ');

    // ... resto del c√≥digo id√©ntico (helpers, red, timer, eventos) ...

    (async function boot(){
      await hardResetSession();
      await send(OPENING_PROMPT);
      input.focus();
    })();
  </script>
</body>
</html>
